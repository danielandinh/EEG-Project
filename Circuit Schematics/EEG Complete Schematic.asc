Version 4
SHEET 1 5588 2080
WIRE -704 -32 -800 -32
WIRE -528 -32 -624 -32
WIRE 48 -32 -448 -32
WIRE 192 -16 112 -16
WIRE 240 -16 192 -16
WIRE 368 -16 320 -16
WIRE 416 -16 368 -16
WIRE 624 -16 496 -16
WIRE 48 0 0 0
WIRE 0 96 0 0
WIRE 0 96 -192 96
WIRE -1648 128 -1648 80
WIRE 0 144 0 96
WIRE 48 144 0 144
WIRE 192 144 192 -16
WIRE 192 144 128 144
WIRE 2160 192 2000 192
WIRE 2304 192 2240 192
WIRE 3376 208 3216 208
WIRE 3520 208 3456 208
WIRE 4352 224 4192 224
WIRE 4496 224 4432 224
WIRE 368 240 368 -16
WIRE 416 240 368 240
WIRE -1648 256 -1648 208
WIRE -1648 256 -1760 256
WIRE -1200 256 -1312 256
WIRE -1040 256 -1120 256
WIRE -800 256 -800 -32
WIRE -800 256 -1040 256
WIRE 624 256 624 -16
WIRE 624 256 480 256
WIRE 1248 256 624 256
WIRE 416 272 368 272
WIRE 1440 272 1312 272
WIRE 1856 272 1440 272
WIRE 2000 272 2000 192
WIRE 2000 272 1936 272
WIRE 2064 272 2000 272
WIRE 1248 288 1120 288
WIRE 2304 288 2304 192
WIRE 2304 288 2128 288
WIRE 2832 288 2304 288
WIRE 3008 288 2912 288
WIRE 3216 288 3216 208
WIRE 3216 288 3008 288
WIRE 3280 288 3216 288
WIRE -1760 304 -1760 256
WIRE -1648 304 -1648 256
WIRE 2064 304 2000 304
WIRE 3520 304 3520 208
WIRE 3520 304 3344 304
WIRE 3968 304 3520 304
WIRE 4192 304 4192 224
WIRE 4192 304 4048 304
WIRE 4256 304 4192 304
WIRE 3280 320 3216 320
WIRE 4496 320 4496 224
WIRE 4496 320 4320 320
WIRE 4656 320 4496 320
WIRE -1312 336 -1312 256
WIRE 3008 336 3008 288
WIRE 4256 336 4192 336
WIRE 2000 352 2000 304
WIRE 48 368 0 368
WIRE 192 368 128 368
WIRE 3216 368 3216 320
WIRE 4192 384 4192 336
WIRE 0 416 0 368
WIRE 0 416 -32 416
WIRE 1120 432 1120 288
WIRE 1248 432 1120 432
WIRE 1440 432 1440 272
WIRE 1440 432 1328 432
WIRE -1648 448 -1648 384
WIRE 2832 464 2736 464
WIRE 3008 464 3008 416
WIRE 3008 464 2912 464
WIRE 3104 464 3008 464
WIRE 3280 464 3184 464
WIRE 0 512 0 416
WIRE 48 512 0 512
WIRE 192 528 192 368
WIRE 192 528 112 528
WIRE 240 528 192 528
WIRE 368 528 368 272
WIRE 368 528 320 528
WIRE 416 528 368 528
WIRE 544 528 496 528
WIRE 2736 528 2736 464
WIRE -800 544 -800 256
WIRE -704 544 -800 544
WIRE -528 544 -624 544
WIRE 48 544 -448 544
WIRE -1040 576 -1040 256
WIRE 544 576 544 528
WIRE 1120 576 1120 432
WIRE 1248 576 1120 576
WIRE 1440 576 1440 432
WIRE 1440 576 1312 576
WIRE 1120 624 1120 576
WIRE -192 720 -192 96
WIRE -144 720 -192 720
WIRE -32 720 -32 416
WIRE -32 720 -64 720
WIRE 1120 736 1120 704
WIRE -192 768 -192 720
WIRE -32 768 -32 720
WIRE -192 896 -192 848
WIRE -32 896 -32 848
WIRE -32 896 -192 896
WIRE -688 960 -752 960
WIRE -752 976 -752 960
WIRE -688 1040 -688 960
WIRE -688 1040 -768 1040
WIRE 944 1040 944 992
WIRE -1040 1056 -1040 656
WIRE -944 1056 -1040 1056
WIRE -832 1056 -944 1056
WIRE -32 1056 -32 896
WIRE -32 1056 -320 1056
WIRE -672 1072 -768 1072
WIRE -592 1072 -672 1072
WIRE -464 1072 -512 1072
WIRE -384 1072 -464 1072
WIRE -224 1088 -320 1088
WIRE -144 1088 -224 1088
WIRE -144 1120 -144 1088
WIRE 752 1136 688 1136
WIRE 880 1136 816 1136
WIRE -464 1152 -464 1072
WIRE -224 1152 -224 1088
WIRE -224 1152 -464 1152
WIRE 2304 1168 2176 1168
WIRE 2112 1184 1984 1184
WIRE -944 1200 -944 1056
WIRE -848 1200 -944 1200
WIRE -672 1200 -672 1072
WIRE -672 1200 -768 1200
WIRE 880 1248 880 1136
WIRE 880 1248 816 1248
WIRE 944 1248 944 1120
WIRE 944 1248 880 1248
WIRE 688 1264 688 1136
WIRE 688 1264 560 1264
WIRE 752 1264 688 1264
WIRE 944 1280 816 1280
WIRE -944 1328 -944 1200
WIRE -848 1328 -944 1328
WIRE -672 1328 -672 1200
WIRE -672 1328 -784 1328
WIRE 944 1328 944 1280
WIRE 1984 1328 1984 1184
WIRE 2112 1328 1984 1328
WIRE 2304 1328 2304 1168
WIRE 2304 1328 2192 1328
WIRE 1984 1424 1984 1328
WIRE 1984 1536 1984 1504
FLAG -1760 304 0
FLAG -1648 80 Vcc
FLAG -1648 448 Vee
FLAG 80 -48 Vee
FLAG 80 16 Vcc
FLAG 448 224 Vcc
FLAG 448 288 Vee
FLAG 80 496 Vcc
FLAG 80 560 Vee
FLAG 1280 304 Vcc
FLAG 1280 240 Vee
FLAG 1120 736 0
FLAG -752 976 0
FLAG -800 1088 Vcc
FLAG -800 1024 Vee
FLAG -1312 336 0
FLAG -352 1104 Vcc
FLAG -352 1040 Vee
FLAG -144 1120 0
FLAG 944 1328 0
FLAG 784 1232 Vcc
FLAG 784 1296 Vee
FLAG 544 576 0
FLAG 2736 528 0
FLAG 3280 464 Vcc
FLAG 3216 368 0
FLAG 2144 1200 Vcc
FLAG 2144 1136 Vee
FLAG 1984 1536 0
FLAG 3312 272 Vcc
FLAG 3312 336 Vee
FLAG 4192 384 0
FLAG 4288 288 Vcc
FLAG 4288 352 Vee
FLAG 2000 352 0
FLAG 2096 256 Vcc
FLAG 2096 320 Vee
SYMBOL OpAmps\\OP07 80 48 M180
SYMATTR InstName U1
SYMBOL OpAmps\\OP07 80 464 R0
SYMATTR InstName U2
SYMBOL res 144 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 25k
SYMBOL res 144 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 25k
SYMBOL res 336 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 40k
SYMBOL res 336 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 40k
SYMBOL OpAmps\\OP07 448 192 R0
SYMATTR InstName U3
SYMBOL res 512 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 40k
SYMBOL res 512 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 40k
SYMBOL res -48 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rg
SYMATTR Value 2.37k
SYMBOL OpAmps\\OP07 1280 336 M180
SYMATTR InstName U4
SYMBOL res 1344 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 1104 608 R0
SYMATTR InstName R8
SYMATTR Value 1.8k
SYMBOL res 1952 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 5.6k
SYMBOL cap 1312 560 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 0.033µ
SYMBOL res -208 752 R0
SYMATTR InstName R11
SYMATTR Value 22k
SYMBOL res -48 752 R0
SYMATTR InstName R12
SYMATTR Value 22k
SYMBOL res -496 1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -752 1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 499k
SYMBOL cap -784 1312 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 0.0056µ
SYMBOL Misc\\signal -608 -32 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 88 60 VBottom 2
WINDOW 39 0 0 Left 0
SYMATTR InstName Electrode1
SYMATTR Value SINE(0 20u 15)
SYMATTR Value2 AC 20u
SYMBOL Misc\\signal -608 544 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 60 56 VTop 2
WINDOW 39 0 0 Left 0
SYMATTR InstName Electrode2
SYMATTR Value SINE(0 0u 0)
SYMATTR Value2 AC 0u
SYMBOL Misc\\signal -1104 256 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 60 56 VTop 2
WINDOW 39 0 0 Left 0
SYMATTR InstName RightLegElectrode
SYMATTR Value SINE(0 0.1 50)
SYMATTR Value2 AC 0.1
SYMBOL res -432 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res -432 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL res -1056 560 R0
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 928 1024 R0
SYMATTR InstName R19
SYMATTR Value 3300k
SYMBOL cap 816 1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 0.1µ
SYMBOL voltage -1648 288 R0
SYMATTR InstName V1
SYMATTR Value 9
SYMBOL voltage -1648 112 R0
SYMATTR InstName V2
SYMATTR Value 9
SYMBOL OpAmps\\OP227 -352 1136 R180
SYMATTR InstName U7
SYMBOL OpAmps\\OP227 -800 1120 R180
SYMATTR InstName U8
SYMBOL OpAmps\\OP07 784 1200 M0
SYMATTR InstName U6
SYMBOL res 2928 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 2.37k
SYMBOL res 2992 320 R0
SYMATTR InstName R20
SYMATTR Value 2.37k
SYMBOL res 2928 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL res 3200 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 4.99k
SYMBOL OpAmps\\OP07 3312 240 R0
SYMATTR InstName U9
SYMBOL res 3472 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 2.37k
SYMBOL OpAmps\\OP07 2144 1232 M180
SYMATTR InstName U10
SYMBOL res 2208 1312 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 100k
SYMBOL res 1968 1408 R0
SYMATTR InstName R25
SYMATTR Value 5.6k
SYMBOL OpAmps\\OP07 4288 256 R0
SYMATTR InstName U11
SYMBOL res 4448 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 10k
SYMBOL res 4064 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 10k
SYMBOL OpAmps\\OP07 2096 224 R0
SYMATTR InstName U12
SYMBOL res 2256 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 100k
TEXT -16 -232 Left 3 ;INA819 Instrumentation Amplifier\nG1 = 22.10\nSim G1 = 23.2
TEXT 1096 72 Left 3 ;Non-inverting Op Amp\nG2 = 56.56\nSim G2 = 53.99
TEXT -1856 -16 Left 3 ;Voltage Source 2x 9V Batteries
TEXT 2000 16 Left 3 ;Inverting Op Amp\nG3 = -17.86\nSim G3 = -17.88
TEXT 4760 264 Left 2 ;Current total gain = 22322.82\n-100uV ~ +100uV after gain = 4.4646Vpp < 5Vpp\n \nSim total gain = 22395.92\n-100uV ~ +100uV after gain = 4.4792Vpp
TEXT 1112 808 Left 2 ;Capacitor acts as active low-pass filter \nfor fc = 1/(2*pi*C*100k) = 48.2288Hz
TEXT -976 1424 Left 2 ;Common mode rejection is improved by a factor of (1 + A). \nThis means a higher gain will improve the circuit"s CMRR, \nas long as there are no stability issues caused by relatively \nhigh gains.
TEXT -976 864 Left 3 ;Driven Right Leg Inverting Op Amp\nG = -49.9
TEXT -480 1216 Left 2 ;Buffer op amp provides low-impedance\nconnection to right leg electrode.
TEXT -1784 536 Left 2 !;ac dec 100 1m 50k
TEXT -1784 584 Left 2 !.tran 0 0.5 0
TEXT 88 792 Left 2 ;Rg determines gain of instrumentation \namplifier INA819. A = 1 + 50k/Rg
TEXT 528 1400 Left 2 ;Optional high-pass filter that connects Rref and the \noutput of the instrumentation amplifier. Connect U6's\noutput with R6 instead of ground. Different C1 value\nwill affect offset of INA819.
TEXT 3016 16 Left 3 ;Inverting Summing Amplifier\nG4 = -1\nOffset = 2.4969V\nSim offset = 2.4969
TEXT 1960 952 Left 3 ;Non-inverting Op Amp\nG3 = 18.86\nSim G3 = 18.88
TEXT 2864 600 Left 2 ;Non-inverting summing amplifier is not a preferable choice since it will introduce\ngain>1 into the system (Av = 1 + Rf/Ri, and Rf/Ri cannot be 0). The system only \nrequires an offset of approximately 2.5V with gain=1. Inverting summing amplifiers\ncan do the job, but requires an additional inverter op amp to bound the signal to\nits acceptable range.\n \nFor voltage divider calculation between R18, R21, and R22, check out \nhttps://www.electronics-tutorials.ws/opamp/opamp_4.html
TEXT 2176 1472 Left 2 ;For easy swapping when editing
TEXT 4112 80 Left 3 ;Inverting Op Amp\nG4 = -1
LINE Normal 800 1008 800 304 1
LINE Normal 768 976 800 1008 1
LINE Normal 832 976 800 1008 1
LINE Normal 2128 864 2160 896 1
LINE Normal 2192 864 2160 896 1
LINE Normal 2192 432 2160 400 1
LINE Normal 2128 432 2160 400 1
LINE Normal 2160 896 2160 400 1
RECTANGLE Normal 688 656 -848 -304 1
